# 投げ銭機能（決済）の導入手順

初心者の方でも簡単に実装できる「Stripe Payment Links」を使った方法を解説します。
この方法なら、難しいプログラミングなしで、安全にクレジットカード決済などを受け付けることができます。

## 手順

### 1. Stripeアカウントの作成
決済代行サービス「Stripe（ストライプ）」のアカウントを作成します。
- [Stripe公式サイト](https://stripe.com/jp) にアクセスし、「今すぐ始める」からアカウント登録してください。
- メールアドレス認証や、事業情報の入力（個人の場合は個人事業主として登録）を行ってください。
  - ※テストモード（本番のお金が動かないモード）ならすぐに試せます。

### 2. 商品（投げ銭）の登録
1. Stripeのダッシュボード（管理画面）にログインします。
2. 左メニューの「商品」をクリックし、「商品を登録」ボタンを押します。
3. 以下の情報を入力します：
   - **名前**: 「うづきちゃんへのおやつ代」など
   - **説明**: 「サイト運営の応援になります」など（任意）
   - **画像**: うづきちゃんの画像をアップロードすると親切です
   - **価格**:
     - **価格モデル**: 「標準の価格体系」
     - **価格**: 500円 など（好きな金額）
     - **請求期間**: 「1回限り」（継続寄付なら「継続」）
4. 「商品を保存」をクリックします。

### 3. 支払いリンクの作成
1. 保存した商品の詳細ページで、「支払いリンクを作成」ボタンをクリックします。
2. プレビュー画面が表示されます。
3. **【重要】支払い後のリダイレクト設定**:
   - 「支払い確認ページ」のタブ（または設定オプション）を探します。
   - 「支払い後に別のページにリダイレクトする」にチェックを入れます。
   - URLに以下を入力してください（本番公開時のURLに合わせてください）：
     - ローカルテスト用: `http://localhost:5000/thanks`
     - 本番用（例）: `https://あなたのサイトのURL/thanks`
4. 「リンクを作成」をクリックします。

### 4. リンクの貼り付け
1. 作成されたリンク（例: `https://buy.stripe.com/test_...`）をコピーします。
2. `templates/index.html` ファイルを開きます。
3. 以下の部分を探し、`href="#"` の `#` をコピーしたリンクに書き換えます。

```html
<!-- 変更前 -->
<a href="#" class="button donate" target="_blank">🥕 おやつをあげる (投げ銭)</a>

<!-- 変更後（例） -->
<a href="https://buy.stripe.com/test_12345..." class="button donate" target="_blank">🥕 おやつをあげる (投げ銭)</a>
```

### 5. 確認
1. アプリを起動（`python application.py`）します。
2. 「おやつをあげる」ボタンをクリックして、Stripeの決済画面に移動することを確認します。
3. テストモードの場合、Stripeが用意しているテスト用カード番号（4242 4242 4242 4242 など）を使って決済を完了させます。
4. 決済完了後、作成した「ありがとうございます！」ページに戻ってくれば成功です！

---

## その他の選択肢
もっと手軽に始めたい場合は、以下のサービスもおすすめです。
- **Buy Me a Coffee**: [https://www.buymeacoffee.com/](https://www.buymeacoffee.com/)
  - アカウントを作ってプロフィールページのURLを貼るだけです。
- **Ofuse**: [https://ofuse.me/](https://ofuse.me/)
  - 日本のサービスで、ファンレターと一緒に投げ銭が送れます。

まずはStripeのテストモードで試してみるのが、Web開発の勉強としてもおすすめです！
